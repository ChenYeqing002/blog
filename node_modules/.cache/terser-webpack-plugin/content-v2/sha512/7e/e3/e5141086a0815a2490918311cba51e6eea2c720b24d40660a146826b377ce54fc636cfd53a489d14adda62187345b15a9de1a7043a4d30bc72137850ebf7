{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{451:function(_,v,t){\"use strict\";t.r(v);var e=t(2),a=Object(e.a)({},(function(){var _=this,v=_._self._c;return v(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":_.$parent.slotKey}},[v(\"h2\",{attrs:{id:\"mysql调优\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#mysql调优\"}},[_._v(\"#\")]),_._v(\" MySQL调优\")]),_._v(\" \"),v(\"h3\",{attrs:{id:\"架构\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#架构\"}},[_._v(\"#\")]),_._v(\" 架构\")]),_._v(\" \"),v(\"p\",[_._v(\"读写分离\")]),_._v(\" \"),v(\"p\",[_._v(\"主从\")]),_._v(\" \"),v(\"p\",[_._v(\"分库分表\")]),_._v(\" \"),v(\"p\",[_._v(\"缓存 双写一致性\")]),_._v(\" \"),v(\"p\",[_._v(\"java数据结构\")]),_._v(\" \"),v(\"h3\",{attrs:{id:\"硬件\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#硬件\"}},[_._v(\"#\")]),_._v(\" 硬件\")]),_._v(\" \"),v(\"p\",[_._v(\"内存 建议32G, 至少大于16G, buffer pool(75%):加载数据页\")]),_._v(\" \"),v(\"p\",[_._v(\"Cpu\")]),_._v(\" \"),v(\"p\",[_._v(\"MySQL版本\")]),_._v(\" \"),v(\"p\",[_._v(\"MySQL连接数  CPU的核心数*2 + 1(固态硬盘)\")]),_._v(\" \"),v(\"p\",[_._v(\"固态硬盘还可以+1\")]),_._v(\" \"),v(\"h3\",{attrs:{id:\"sql\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#sql\"}},[_._v(\"#\")]),_._v(\" SQL\")]),_._v(\" \"),v(\"h5\",{attrs:{id:\"平时注意的点\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#平时注意的点\"}},[_._v(\"#\")]),_._v(\" 平时注意的点\")]),_._v(\" \"),v(\"p\",[_._v(\"SELECT * 要避免, 用什么查什么字段\")]),_._v(\" \"),v(\"p\",[_._v(\"不要重复查询, 可以把第一次查询出来的数据存起来, 作为参数传递\")]),_._v(\" \"),v(\"p\",[_._v(\"limit    主键id是自增类型时可以通过 \"),v(\"code\",[_._v(\"where id>10000 limit 20\")]),_._v(\"来优化\")]),_._v(\" \"),v(\"p\",[_._v(\"update 只更新需要的字段, 而不要全部查出来, 修改对象后再全部更新\")]),_._v(\" \"),v(\"p\",[_._v(\"日期    datetime  8\")]),_._v(\" \"),v(\"p\",[_._v(\"timestamp  4  1970年1月1号 - 2038年, 带小数时占用8位\")]),_._v(\" \"),v(\"p\",[_._v(\"date  3\")]),_._v(\" \"),v(\"p\",[_._v(\"订单状态之类可以用 tinyint 1, enum\")]),_._v(\" \"),v(\"p\",[_._v(\"可以确定长度的字符可以用char(), 比如手机号\")]),_._v(\" \"),v(\"p\",[_._v(\"对于一些用for循环单挑插入的数据用批量插入语法\")]),_._v(\" \"),v(\"h3\",{attrs:{id:\"系统配置\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#系统配置\"}},[_._v(\"#\")]),_._v(\" 系统配置\")]),_._v(\" \"),v(\"p\",[_._v(\"redolog 刷盘策略\"),v(\"code\",[_._v(\"innodb_flush_log_trx_commit\")])]),_._v(\" \"),v(\"ul\",[v(\"li\",[v(\"p\",[_._v(\"1秒刷盘一次\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"commit一次刷盘一次(性能最差)\")])]),_._v(\" \"),v(\"li\",[v(\"p\",[_._v(\"操作系统去进行刷盘\")])])]),_._v(\" \"),v(\"p\",[_._v(\"binlog刷盘策略\"),v(\"code\",[_._v(\"sync_binlog\")])]),_._v(\" \"),v(\"ul\",[v(\"li\",[_._v(\"代表几次提交binlog就刷盘一次\")])]),_._v(\" \"),v(\"h3\",{attrs:{id:\"慢sql\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#慢sql\"}},[_._v(\"#\")]),_._v(\" 慢SQL\")]),_._v(\" \"),v(\"p\",[v(\"code\",[_._v(\"slow_query_log\")]),_._v(\"是否开启慢sql日志\")]),_._v(\" \"),v(\"p\",[v(\"code\",[_._v(\"long_query_time\")]),_._v(\" 多少时间算慢sql的阈值\")]),_._v(\" \"),v(\"p\",[v(\"code\",[_._v(\"忘记叫什么\")]),_._v(\"有没有走索引\")]),_._v(\" \"),v(\"p\",[v(\"code\",[_._v(\"%slow_query_log%\")]),_._v(\"慢SQL日志文件位置\")]),_._v(\" \"),v(\"p\",[_._v(\"Explain(SQL执行计划)\")]),_._v(\" \"),v(\"p\",[_._v(\"Type  system  const  eq_ref  ref  range  index  all(全表扫描)\")]),_._v(\" \"),v(\"p\",[_._v(\"等值: where xx=xx\")]),_._v(\" \"),v(\"p\",[_._v(\"主键索引或者唯一索引就是 \"),v(\"code\",[_._v(\"const\")])]),_._v(\" \"),v(\"p\",[_._v(\"普通索引就是\"),v(\"code\",[_._v(\"ref\")])]),_._v(\" \"),v(\"p\",[v(\"code\",[_._v(\"eq_ref\")]),_._v(\"是在关联到另一个表的唯一索引时的类型\")]),_._v(\" \"),v(\"p\",[_._v(\"两个表关联的字段不一样就会出现索引失效\")]),_._v(\" \"),v(\"h3\",{attrs:{id:\"索引\"}},[v(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#索引\"}},[_._v(\"#\")]),_._v(\" 索引\")]),_._v(\" \"),v(\"p\",[_._v(\"最左前缀原则\")]),_._v(\" \"),v(\"p\",[_._v(\"索引覆盖\")]),_._v(\" \"),v(\"p\",[_._v(\"索引下推\")]),_._v(\" \"),v(\"p\",[_._v(\"主键尽量使用自增主键,减少页分裂\")]),_._v(\" \"),v(\"p\",[_._v(\"长字段使用前缀索引\")]),_._v(\" \"),v(\"p\",[_._v(\"避免既用ASC, 又用DESC\")]),_._v(\" \"),v(\"p\",[_._v(\"like可能会索引失效\")]),_._v(\" \"),v(\"p\",[_._v(\"范围查询应该放到最后(联合索引中范围索引后面都会失效)\")]),_._v(\" \"),v(\"p\",[_._v(\"or, 左右两边有一个字段没有索引就会导致全表扫描\")]),_._v(\" \"),v(\"p\",[_._v(\"update 的where条件如果没有索引, 在可重复读隔离级别下会锁表\")]),_._v(\" \"),v(\"div\",{staticClass:\"language-mysql extra-class\"},[v(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[v(\"code\",[_._v(\"# 查看哪些表被锁着\\nshow open tables where in_use > 0\\n\\n# 正在执行的事务\\nselect * from information_schema.innodb_trx\\n\\n\")])])]),v(\"p\",[_._v(\"不要在索引列上做任何操作, 比如 id+1 = 700, 或者 substr(data, 1, 3)='100'\")])])}),[],!1,null,null,null);v.default=a.exports}}]);","extractedComments":[]}